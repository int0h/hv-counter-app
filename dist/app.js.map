{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/hv-jsx/src/blocks/abstract.ts","webpack:///./node_modules/hyper-value/src/index.ts","webpack:///./node_modules/hv-jsx/src/hash.ts","webpack:///./node_modules/hyper-value/src/scopes/base.ts","webpack:///./node_modules/hv-jsx/src/blocks/common.ts","webpack:///./node_modules/hv-jsx/src/index.ts","webpack:///./node_modules/hyper-value/src/scopes/auto.ts","webpack:///./node_modules/hyper-value/src/debug/index.ts","webpack:///./node_modules/hv-jsx/src/utils.ts","webpack:///./node_modules/hv-jsx/src/debug.ts","webpack:///./node_modules/hyper-value/src/scopes/proxy.ts","webpack:///./node_modules/hyper-value/src/scopes/cast.ts","webpack:///./node_modules/hyper-value/src/core/index.ts","webpack:///./node_modules/hv-jsx/src/blocks/element.ts","webpack:///./node_modules/hv-jsx/src/merge.ts","webpack:///./node_modules/hv-jsx/src/blocks/zone.ts","webpack:///./node_modules/hv-jsx/src/blocks/component.ts","webpack:///./node_modules/hyper-value/src/scopes/object.ts","webpack:///./node_modules/hyper-value/src/scopes/async.ts","webpack:///./node_modules/hyper-value/src/utils/mixin.ts","webpack:///./node_modules/hyper-value/src/scopes/array.ts","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/hyper-value/src/core/dispatcher.ts","webpack:///./node_modules/hyper-value/src/core/record.ts","webpack:///./node_modules/hyper-value/src/core/core.ts","webpack:///./node_modules/hv-dom/src/domHelpers.ts","webpack:///./node_modules/hv-dom/src/style.ts","webpack:///./node_modules/hv-dom/src/events.ts","webpack:///./node_modules/hv-dom/src/index.ts","webpack:///./node_modules/hv-jsx/src/jsx.ts","webpack:///./node_modules/hv-jsx/src/blocks/placeholder.ts","webpack:///./node_modules/hv-jsx/src/blocks/string.ts","webpack:///./node_modules/hyper-value/src/scopes/full.ts","webpack:///./node_modules/hyper-value/src/scopes/index.ts","webpack:///./node_modules/debug-tools/src/flameChart.ts","webpack:///./node_modules/debug-tools/src/report.ts","webpack:///./node_modules/debug-tools/src/utils.ts","webpack:///./node_modules/debug-tools/src/debug.ts","webpack:///./node_modules/debug-tools/src/index.ts","webpack:///./node_modules/hyper-value/src/debug/hv.ts","webpack:///./node_modules/hyper-value/src/debug/scope.ts","webpack:///./node_modules/hyper-value/src/utils/list.ts","webpack:///./src/app.tsx"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","AbstractElement","free","core_1","HyperValue","scopes","debug_1","tracer","uniqObjects","WeakMap","currentId","hash","obj","undefined","_a","String","cached","id","result","set","stringify","hr","JSON","hashDict","res","_i","keys_1","keys","sort","length","hashArray","arr","map","item","hashBlock","params","dispatcher_1","BaseScope","this","watcherList","children","watch","hv","fn","hvId","watcherId","globalDispatcher","watcherSet","unwatch","tolerate","Error","catch","catcher","fail","error","details","Number","forEach","child","regChild","push","__decorate","scopeDebug","hyper_value_1","abstract_1","utils_1","string_1","zone_1","placeholder_1","normalizeNodeSet","hs","StringElm","PlaceholderElm","normalize","Array","isArray","array","flatArray","content","proxy","HyperZone","targetRenderChildren","meta","ProxyScope","node","targetRender","component_1","Component","closestComponent","jsx_1","jsx","common_1","element_1","registerGlobalProp","debugTargetProxy","AutoScope","_super","__extends","bind","init","_this","depList","watchDeps","hvIdList","watcher","needInit","depList_1","dep","deps","record","oldValue","$","auto","toBeReported","outputWarns","objList","warns_1","filter","has","indexOf","w","console","warn","msg","_debug","report","setTimeout","scope_1","hv_1","hvDebug","traceHv","concat","global","performance","now","Date","targetTime","target","fnName","args","arguments","startTime","apply","endTime","renderDebug","traceMethod","constructor","window","createReport","data","code","ifr","document","createElement","setAttribute","body","appendChild","contentDocument","write","setter","CastScope","cast","read","g","record_1","recordAsync","hash_1","merge_1","refProps","HyperElm","tagName","props","FullScope","propHv","childrenHash","propHash","type","attrs","initAttrs","newAttrs","oldAttrs","diff","setProp","targetMeta","targetNode","owner","propObj","setChildren","nestedMeta","t","_b","elems_1","elem","append","mergeProps","newProps","merge","newElem","targetNodes","mergeChildren","create","selfTargetMeta","nestedTargetMeta","__assign","selfMeta","matcher","handler","oldChildren","newChildren","preparedChildren","newChild","index","oldChild","oldNodes","newNodes","replaceSequence","getTargetNodes","elems","needRender","newElems","oldElems","newZone","componentTable","renderHs","mockHs","hsBackup","domHv","render","domZone","mapAttrs","data-hv-id","setData","compId","newComp","hvComponent","isComponentClass","found","closest","getData","ObjectScope","prop","propertyName","getProp","base_1","HvAsync","initial","state","callId","update","then","initPromise","currentPromise","Promise","resolve","reject","resolver","rejecter","fetch","wait","newValue","AsyncScope","async","mix","baseClass","mixClass","NewClass","baseCtor","baseProto","proto","getPrototypeOf","reverse","getPrototypeChain","dstObj","srcObj","getOwnPropertyNames","mixSome","classes","slice","ctor","auto_1","cast_1","mixin_1","Base","ArrayScope","mapFn","every","some","reduce","reducer","find","findIndex","hvs","arrays","start","end","e","insert","newArray","remove","sortFn","Function","eval","list_1","HvDispatcher","watcherSets","lastErrorDetails","currentSet","watchers","List","add","del","handle","entries","hvRecordStart","recordedHvStack","hvRecordStop","pop","addToRecords","currentList","noNewDeps","newDeps","finalDeps","initialValue","updating","silent","nsTable","html","svg","parent","parentElement","removeChild","parentMeta","elm","appendSequence","from","currentNs","selfNs","childNs","guessNs","ns","createElementNS","createPlaceholder","createTextNode","text","dataset","replace","oldElem","newElm","replaceChild","newElms","lastOld","nextSibling","oldElems_1","newElms_1","insertBefore","name_1","Text","styleHv","styles","value_1","style","hv_jsx_1","event","toLowerCase","domHelpers_1","renderDom","contextMeta","dom","defaultTargetMeta","renderIn","where","innerHTML","what","fc","FC","newPlaceholder","newString","array_1","async_1","object_1","proxy_1","full_1","default","flameChart_1","genReport","renderStack","isNaN","time","total","cur","createReportIframe","json","flame","textContent","app","Tracer","history","callStack","NaN","totalChildren","getName","key","descriptor","getOwnPropertyDescriptor","originalMethod","self","logCall","subInfo","report_1","debug_tools_1","currentDepth","depth","pipeLog","glob","getHvHistory","sign","repeat","join","_1","_watcherCount","items","hv_dom_1","App","clickTimes","lastClickTime","sliceStart","showedLog","handleClick","Infinity","handleShowedCountChnage","onClick","onInput","dateString","toString"],"mappings":"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rY,EAAA,IAKI,SACA,gBACA,QACA,eACA,UACA,iBAGA,mBACA,0BACA,qBACA,4BACA,sBACA,6BAGA,UACA,iBACA,SACA,gBAGA,WACA,kBACA,UACA,iBACA,UACA,iBACA,WACA,kBACA,YACA,mBAGA,SACA,gBACA,UACA,iBAGA,YACA,mBACA,aACA,oBACA,UACA,iBAGA,UACA,iBACA,YACA,mBACA,mBACA,0BACA,mBACA,0BACA,YACA,mBACA,cACA,qBACA,UACA,iBACA,eACA,sBACA,mBACA,0BACA,cACA,qBACA,UACA,iBACA,SACA,gBACA,YACA,mBACA,aACA,oBACA,eACA,sBACA,WACA,kBACA,YACA,mBACA,YACA,mBACA,YACA,mBACA,eACA,sBACA,iBACA,wBACA,YACA,mBAGA,UACA,iBACA,gBACA,uBACA,aAEA,SACA,gBACA,YACA,mBACA,cACA,qBACA,aACA,oBACA,cACA,qBACA,aACA,oBACA,cACA,qBACA,SACA,gBACA,cACA,qBACA,eACA,eACA,cACA,qBACA,aACA,oBACA,cACA,qBACA,YACA,mBAGA,WACA,kBAGA,gBACA,uBACA,aACA,oBACA,cACA,qBACA,eACA,sBAGA,WACA,kBAGA,UACA,iBAGA,mBACA,0BACA,iBACA,wBACA,uBACA,8BAGA,kBACA,0BAGOqF,QAAQ,SAAAiT,GACfD,EAAA5Q,mBAAmB6Q,EAAO,SAAC5V,OAAC2K,EAAA3K,EAAA2K,MAAW1M,GAAJ+B,EAAAwD,GAAIxD,EAAA/B,MAAMS,EAAAsB,EAAAtB,MAC5BiM,EAAMD,WACLzM,EAAK4X,eAAiBnX,qFC5K5C,IAAAiX,EAAArY,EAAA,GAUAA,EAAA,IAMAA,EAAA,IAEA,IAAAwY,EAAAxY,EAAA,IAsCA,SAAAyY,EAA0BnR,EAAevD,QAAA,IAAAA,UACrC,IAAM2U,GACFrO,OAAQgO,EAAA3Q,iBAAiBxH,EAAAyY,KACzBxL,WAAYjN,EAAA0Y,mBAGhB,OAAOP,EAAAxR,qBAAqB6R,EAAapR,GA5BhCpH,EAAAyY,KACT9K,OAAM2K,EAAA3K,OACN4C,QAAO+H,EAA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","file":"./app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 42);\n","import {HyperValue} from 'hyper-value';\nimport {Dict, NestedArray} from '../utils';\nimport {Target} from '../target';\n\nexport abstract class AbstractElement {\n    free() {}\n    targetNodes!: TargetNode[];\n    hash!: string;\n    abstract targetRender(meta: ContextMeta): TargetNode[];\n    abstract merge(meta: ContextMeta, newBlock: AbstractElement): AbstractElement;\n}\n\nexport declare class As<S extends string> {\n    private as: S;\n}\n\nexport type Props = Dict<any>;\n\nexport type PropsAbstract = Dict<any>;\n\nexport type HvNode = AbstractElement;\n\nexport type HvNodeSet = HvNode | HvNode[];\n\n// child types:\n\nexport type ChildNodePrimitive = HvNode | string | number | boolean | undefined | null;\n\nexport interface ChildHvNode extends HyperValue<ChildHvNode | ChildNodePrimitive> {}\n\nexport type ChildNode = ChildNodePrimitive | ChildHvNode;\n\nexport interface ChildNodeArray extends NestedArray<ChildNode> {}\n\nexport interface NestedHv<T> extends HyperValue<T | NestedHv<T>> {}\n\nexport type Children = ChildNode\n    | HyperValue<ChildNode | NestedArray<ChildNode>>\n    | NestedArray<HyperValue<ChildNode | NestedArray<ChildNode>> | ChildNode | NestedArray<ChildNode>>;\n\n// target types:\n\nexport type TargetNode = any;\n\nexport type TargetMeta = any;\n\nexport type TargetPosition = any;\n\nexport type TargetData = {\n    compId?: number;\n};\n\nexport type TargetMock = Target<TargetNode, TargetMeta, TargetPosition, TargetData>;\n\n// etc:\n\nexport interface ContextMeta {\n    mapAttrs?: (attrs: PropsAbstract) => PropsAbstract;\n    targetMeta: TargetMeta;\n    target: TargetMock;\n}\n\nexport interface Ref {\n    (elm: AbstractElement): void;\n}\n","export {HyperValue} from './core';\n\nimport * as scopes from './scopes';\nexport {scopes};\n\nexport {tracer} from './debug';\n","const uniqObjects = new WeakMap();\nlet currentId = 0;\n\nexport type HashResult = boolean | number | string | {null: true} | {undefined: true} | {o: number};\n\nexport function hash(obj: any): HashResult {\n    if (obj === null || obj === undefined) {\n        return {[String(obj)]: true} as HashResult;\n    }\n    if (\n        typeof obj === 'boolean' ||\n        typeof obj === 'string' ||\n        typeof obj === 'number'\n    ) {\n        return obj;\n    }\n    const cached = uniqObjects.get(obj);\n    if (cached !== undefined) {\n        return cached;\n    }\n    const id = currentId;\n    currentId++;\n    const result = {o: id};\n    uniqObjects.set(obj, result);\n    return result;\n}\n\nexport function stringify(hr: HashResult | any): string {\n    return JSON.stringify(hr);\n}\n\nexport function hashDict(obj: {[key: string]: any}): {[key: string]: HashResult} {\n    const res: any = {};\n    const keys = Object.keys(obj).sort();\n    for (const name of keys) {\n        res[name] = hash(obj[name]);\n    }\n    return res;\n}\n\nexport function hashArray(arr: any[]): HashResult[] {\n    return arr.map(item => hash(item));\n}\n\nexport interface HashParams {\n    type: string;\n    [key: string]: HashResult | {[key: string]: HashResult} | HashResult[];\n}\n\nexport function hashBlock(params: HashParams): string {\n    return JSON.stringify(params);\n}\n","import {HyperValue} from '../core/core';\nimport {globalDispatcher, WatcherFn, Catcher, ErrorDetails} from '../core/dispatcher';\nimport {IdDict} from '../utils/list';\nimport {scopeDebug} from '../debug';\n\n@scopeDebug\nexport class BaseScope {\n    private watcherList: IdDict<IdDict<number>> = {};\n    private children: BaseScope[] = [];\n\n    watch<T>(hv: HyperValue<T> | number, fn: WatcherFn<T>): number {\n        const hvId = typeof hv === 'number'\n            ? hv\n            : hv.id;\n        const watcherId = globalDispatcher.watch(hvId, fn);\n        let watcherSet = this.watcherList[hvId];\n        if (!watcherSet) {\n            watcherSet = {};\n            this.watcherList[hvId] = watcherSet;\n        }\n        watcherSet[watcherId] = watcherId;\n        return watcherId;\n    }\n\n    unwatch(hv: HyperValue<any> | number, watcherId: number, tolerate?: boolean) {\n        const hvId = typeof hv === 'number'\n            ? hv\n            : hv.id;\n        const watcherSet = this.watcherList[hvId];\n        if (!watcherSet) {\n            if (tolerate) {\n                return;\n            }\n            throw new Error('incorrect hv ID');\n        }\n        delete watcherSet[watcherId];\n        globalDispatcher.unwatch(hvId, watcherId);\n    }\n\n    catch(hv: HyperValue<any> | number, catcher: Catcher) {\n        const hvId = typeof hv === 'number'\n            ? hv\n            : hv.id;\n\n        globalDispatcher.catch(hvId, catcher);\n    }\n\n    fail(hv: HyperValue<any> | number, error: Error, details?: ErrorDetails) {\n        const hvId = typeof hv === 'number'\n            ? hv\n            : hv.id;\n\n        globalDispatcher.fail(hvId, error, details);\n    }\n\n    free() {\n        for (const hvId in this.watcherList) {\n            const watcherSet = this.watcherList[hvId];\n            for (const watcherId in watcherSet) {\n                this.unwatch(Number(hvId), Number(watcherId));\n            }\n        }\n        this.watcherList = {};\n        this.children.forEach(child => child.free());\n    }\n\n    regChild(child: BaseScope) {\n        this.children.push(child);\n    }\n}\n","\nimport {HyperValue, scopes} from 'hyper-value';\nimport {AbstractElement, HvNode, Children, TargetNode, ContextMeta} from './abstract';\nimport {flatArray} from '../utils';\nimport {StringElm} from './string';\nimport {HyperZone} from './zone';\nimport {PlaceholderElm} from './placeholder';\n\nexport function normalizeNodeSet(hs: scopes.ProxyScope, children: Children): HvNode[] {\n    if (typeof children === 'string') {\n        return [new StringElm(children)];\n    }\n    if (typeof children === 'number') {\n        return [new StringElm(String(children))];\n    }\n    if (!children) {\n        return [new PlaceholderElm()];\n    }\n    if (children instanceof AbstractElement) {\n        return [children];\n    }\n\n    const normalize = (children: Children) => normalizeNodeSet(hs, children);\n\n    if (Array.isArray(children)) {\n        const array = flatArray<HvNode>(children.map(normalize));\n        return array.length > 0\n            ? array\n            : [new PlaceholderElm()];\n    }\n    if (children instanceof HyperValue) {\n        const content = hs.proxy(children, normalize);\n        return [new HyperZone(content)];\n    }\n    throw new Error('invalid child');\n}\n\nexport function targetRenderChildren(meta: ContextMeta, children: Children): TargetNode[] {\n    const hs = new scopes.ProxyScope();\n\n    return flatArray(\n        normalizeNodeSet(hs, children)\n            .map(node => node.targetRender(meta)\n        )\n    );\n}\n","export {HvNode, ContextMeta, AbstractElement, Children} from './blocks/abstract';\n\nexport {Component, closestComponent} from './blocks/component';\nexport {jsx} from './jsx';\n\nexport {Target} from './target';\n\nexport {targetRenderChildren} from './blocks/common';\n\nexport {registerGlobalProp} from './blocks/element';\n\nexport {debugTargetProxy} from './debug';\n","import {HyperValue, record} from '../core';\nimport {BaseScope} from './base';\n\ninterface Dep {\n    watcherId: number;\n    hvId: number;\n}\n\nexport class AutoScope extends BaseScope {\n    bind<T>(hv: HyperValue<T>, fn: () => T, init = true) {\n        let depList = [] as Dep[];\n\n        const watchDeps = (hvIdList: number[]) => {\n            return hvIdList.map(hvId => {\n                return {\n                    hvId,\n                    watcherId: this.watch(hvId, watcher.bind(null, true))\n                };\n            });\n        };\n\n        const watcher = (needInit: boolean) => {\n            // do we need it still?\n            for (const dep of depList) {\n                this.unwatch(dep.hvId, dep.watcherId, true);\n            }\n\n            let value, deps;\n\n            try {\n                [value, deps] = record(fn);\n            } catch (error) {\n                this.fail(hv, error, {\n                    oldValue: hv.$\n                });\n                depList = watchDeps(depList.map(dep => dep.hvId));\n                return;\n            }\n\n            depList = watchDeps(deps.map(hv => hv.id));\n\n            if (needInit) {\n                hv.s(value);\n            }\n        };\n\n        watcher(init);\n    }\n\n\n    auto<T>(fn: () => T): HyperValue<T> {\n        const hv = new HyperValue(null as any as T);\n        this.bind(hv, fn, true);\n        return hv;\n    }\n}\n","let toBeReported: {obj: any, msg: string}[] = [];\n\nexport function report(obj: any, msg: string) {\n    if (toBeReported.length === 0) {\n        setTimeout(outputWarns, 1000);\n    }\n\n    toBeReported.push({obj, msg});\n}\n\nfunction outputWarns() {\n    if (toBeReported.length === 0) {\n        return;\n    }\n\n    const objList: any[] = [];\n    const warns = toBeReported.filter(({obj}) => {\n        const has = objList.indexOf(obj) !== -1;\n        if (!has) {\n            objList.push(obj);\n        }\n        return !has;\n    });\n    for (const w of warns) {\n        console.warn(w.msg, w.obj, w.obj._debug);\n    }\n\n    toBeReported = [];\n}\n\nexport {scopeDebug} from './scope';\nexport {hvDebug, traceHv, tracer} from './hv';\n","export interface NestedArray<T> extends Array<T | NestedArray<T>> {}\n\nexport function flatArray<T>(arr: NestedArray<T>): T[] {\n    let res: any[] = [];\n    arr.forEach(item => {\n        if (!Array.isArray(item)) {\n            res.push(item);\n            return;\n        }\n        res = res.concat(flatArray(item));\n    });\n    return res;\n}\n\nexport interface Dict<T> {\n    [key: string]: T;\n}\n","// import {Component} from './blocks/component';\n// import {HyperZone} from './blocks/zone';\nimport {Dict} from './utils';\nimport {Target} from './target';\nimport {tracer} from 'hyper-value';\n\n// interface RenderInfo {\n//     name: string;\n//     children: RenderInfo[];\n//     parent: RenderInfo | null;\n//     time: number;\n//     isDead?: boolean;\n//     instance?: DebugObject;\n//     targetTime?: number;\n//     report?: FlameReport;\n// }\n\n// let renderStack: RenderInfo | null = {\n//     name: 'root',\n//     children: [],\n//     parent: null,\n//     time: NaN\n// };\n\n// let childrenRendered = 0;\n\n\ndeclare let performance: {\n    now: () => number;\n};\n\nif (typeof (global as any).performance === 'undefined') {\n    (global as any).performance = {\n        now: () => Date.now()\n    };\n}\n\n// let sourceToComponents: Dict<> = {};\n\ninterface FlameReport {\n    name: string;\n    value: number;\n    children?: FlameReport[];\n}\n\n// function genReport(renderStack: RenderInfo): FlameReport {\n//     const name = renderStack.name;\n//     const value = isNaN(renderStack.time)\n//         ? (renderStack.children || []).reduce((total, cur) => total + cur.time, 0)\n//         : renderStack.time;\n\n//     if (!renderStack.children || renderStack.children.length <= 0) {\n//         return {name, value};\n//     }\n\n//     const children = renderStack.children.map(genReport);\n\n//     return {name, value, children};\n// }\n\n// type DebugObject = Component<any> | HyperZone;\n\n// function extractObjectInfo(comp: DebugObject) {\n//     return (comp.constructor as any).name;\n// }\n\n// function now(): number {\n//     return Math.round(performance.now() * 100) / 100;\n// }\n\n// function callLog<T>(comp: DebugObject, fn: () => T): T {\n//     const subInfo = {\n//         name: extractObjectInfo(comp),\n//         children: [],\n//         parent: renderStack,\n//         time: NaN,\n//         instance: comp\n//     };\n\n//     if (renderStack === null) {\n//         throw new Error('render stack failed');\n//     }\n\n//     renderStack.children.push(subInfo);\n//     renderStack = subInfo;\n\n//     const startTime = performance.now();\n//     const result = fn();\n//     const endTime = performance.now();\n\n//     childrenRendered++;\n\n//     renderStack.time = Math.round((endTime - startTime) * 100) / 100;\n\n//     renderStack.targetTime = targetTime + renderStack.children\n//         .map(child => child.targetTime || 0)\n//         .reduce((total, cur) => total + cur, 0);\n//     targetTime = 0;\n\n\n//     renderStack = renderStack.parent;\n\n//     if (renderStack === null) {\n//         throw new Error('render stack failed');\n//     }\n\n//     if (renderStack.parent === null) {\n//         console.log('children rendered:', childrenRendered);\n//         childrenRendered = 0;\n//         renderStack.report = genReport(renderStack);\n//         console.log(renderStack);\n//         renderStack = {\n//             name: 'root',\n//             children: [],\n//             parent: null,\n//             time: NaN,\n//         };\n//     }\n\n//     return result;\n// }\n\nlet targetTime = 0;\n\nexport function debugTargetProxy<T extends Target<any, any, any, any>>(target: T): T {\n    let result: Dict<Function> = {};\n\n    for (const fnName in target) {\n        result[fnName] = function (...args: any[]) {\n            const startTime = performance.now();\n            const result: any = (target[fnName] as any as Function).apply(this, args);\n            const endTime = performance.now();\n            targetTime = targetTime + endTime - startTime;\n            return result;\n        };\n    }\n\n    return result as any as T;\n}\n\nexport const renderDebug = tracer.traceMethod(target => (target.constructor as any).name);\n\n// export function renderDebug(target: Object, key: string, descriptor: PropertyDescriptor) {\n//     if (descriptor === undefined) {\n//         descriptor = Object.getOwnPropertyDescriptor(target, key) as PropertyDescriptor;\n//     }\n\n//     const originalMethod = descriptor.value;\n\n//     descriptor.value = function (this: Component<any>, ...args: any[]) {\n//         return callLog(this, () => originalMethod.apply(this, args));\n//     };\n\n//     return descriptor;\n\n// }\n\ndeclare const window: any;\n\nif (typeof window !== 'undefined') {\n    window.createReport = createReport;\n}\n\nfunction createReport(data: FlameReport) {\n    const json = JSON.stringify(data);\n    const code = `<html>\n        <head>\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/gh/spiermar/d3-flame-graph@1.0.4/dist/d3.flameGraph.min.css\">\n        </head>\n        <body>\n            <div id=\"chart\"></div>\n            <script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/d3/4.10.0/d3.min.js\"></script>\n            <script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.7.1/d3-tip.min.js\"></script>\n            <script type=\"text/javascript\" src=\"https://cdn.jsdelivr.net/gh/spiermar/d3-flame-graph@1.0.4/dist/d3.flameGraph.min.js\"></script>\n            <script type=\"text/javascript\">\n            var data = ${json};\n\n            var flamegraph = d3.flameGraph()\n                .width(960);\n\n            d3.select(\"#chart\")\n                .datum(data)\n                .call(flamegraph);\n            </script>\n        </body>\n    </html>`;\n\n    const ifr = window.document.createElement('iframe');\n    ifr.setAttribute('width', '100%');\n    ifr.setAttribute('height', '1000px');\n    window.document.body.appendChild(ifr);\n    ifr.contentDocument.write(code);\n}\n\n// export function trackComponent\n","import {HyperValue} from '../core/core';\nimport {AutoScope} from './auto';\n\nexport class ProxyScope extends AutoScope {\n    proxy<I, O>(\n        hv: HyperValue<I>,\n        getter: (innerValue: I) => O,\n        setter?: (outerValue: O) => I\n    ): HyperValue<O> {\n        const result = this.auto(() => getter(hv.$));\n\n        if (setter) {\n            this.bind(hv, () => setter(result.$), false);\n        }\n\n        return result;\n    }\n}\n","import {HyperValue} from '../core/core';\nimport {BaseScope} from './base';\n\nexport class CastScope extends BaseScope {\n    cast<T>(hv: HyperValue<T> | T): HyperValue<T> {\n        return hv instanceof HyperValue\n            ? hv\n            : new HyperValue(hv);\n    }\n\n    read<T>(hv: HyperValue<T> | T): T {\n        return hv instanceof HyperValue\n            ? hv.g()\n            : hv;\n    }\n}\n","export {HyperValue} from './core';\nexport {PromiseWrapper, record, recordAsync, WatcherFn, WatcherId} from './record';\n","import {HyperValue, scopes} from 'hyper-value';\nimport {FSType} from 'hyper-value/types/scopes/full';\nimport {hashBlock, hashDict, stringify, hashArray} from '../hash';\nimport {mergeChildren} from '../merge';\n\nimport {\n    normalizeNodeSet\n} from './common';\n\nimport {\n    AbstractElement,\n    ContextMeta,\n    PropsAbstract,\n    Ref,\n    HvNode,\n    Children,\n    TargetNode\n} from './abstract';\n\nexport interface RefHandler<T> {\n    ({value, name, owner, hs}: {value: T, name: string, owner: HyperElm, hs: FSType}): void;\n}\n\ninterface RefProps {\n    [name: string]: RefHandler<any>;\n}\n\nconst refProps: RefProps = {};\n\nexport class HyperElm extends AbstractElement {\n    targetNode: TargetNode;\n    tagName: string;\n    props: PropsAbstract;\n    children: HvNode[];\n    childrenHash: string;\n    propHash: string;\n    private hs = new scopes.FullScope();\n    private propHv: HyperValue<PropsAbstract> | null = null;\n\n    constructor (tagName: string, props: PropsAbstract, children: Children) {\n        super();\n        this.tagName = tagName;\n        this.props = props || {};\n        this.children = normalizeNodeSet(this.hs, children);\n        this.childrenHash = stringify(hashArray(this.children.map(child => child.hash)));\n        this.propHash = stringify(hashDict(props));\n        this.hash = hashBlock({\n            type: 'element',\n            tagName: tagName,\n            attrs: this.propHash,\n            children: this.childrenHash\n        });\n    }\n\n    private initAttrs(meta: ContextMeta) {\n        this.propHv = new HyperValue({});\n\n        this.hs.watch(this.propHv, (newAttrs, oldAttrs) => {\n            const diff: PropsAbstract = {};\n            for (const name in newAttrs) {\n                diff[name] = newAttrs[name];\n            }\n\n            for (const name in oldAttrs) {\n                if (!(name in newAttrs)) {\n                    diff[name] = null;\n                }\n            }\n\n            for (const name in diff) {\n                if (name in refProps) {\n                    continue;\n                }\n                meta.target.setProp(meta.targetMeta, this.targetNode, name, diff[name]);\n            }\n\n            for (const name in diff) {\n                if (name in refProps) {\n                    refProps[name]({\n                        name,\n                        value: diff[name],\n                        hs: this.hs,\n                        owner: this\n                    });\n                }\n            }\n        });\n\n        this.hs.bind(this.propHv, () => {\n            const propObj: PropsAbstract = {};\n\n            for (const name in this.props) {\n                propObj[name] = this.hs.read(this.props[name]);\n            }\n\n            return propObj;\n        });\n    }\n\n    private setChildren(meta: ContextMeta, nestedMeta: ContextMeta) {\n        const t = meta.target;\n        for (let child of this.children) {\n            const elems = child.targetRender(meta);\n            for (let elem of elems) {\n                t.append(meta.targetMeta, nestedMeta.targetMeta, this.targetNode, elem);\n            }\n        }\n    }\n\n    private mergeProps(meta: ContextMeta, newProps: PropsAbstract) {\n        if (!this.propHv) {\n            throw new Error('merge before render');\n        }\n\n        this.propHv.$ = newProps;\n    }\n\n    merge(meta: ContextMeta, newElem: HyperElm): HyperElm {\n        if (newElem.hash === this.hash) {\n            newElem.targetNodes = this.targetNodes;\n            newElem.props = this.props;\n            newElem.children = this.children;\n            return newElem;\n        }\n\n        if (newElem.tagName !== this.tagName) {\n            return newElem;\n        }\n\n        newElem.targetNode = this.targetNode;\n        newElem.targetNodes = this.targetNodes;\n        newElem.propHv = this.propHv;\n\n        if (newElem.propHash !== this.propHash) {\n            this.mergeProps(meta, newElem.props);\n        }\n\n        if (newElem.childrenHash !== this.childrenHash) {\n            mergeChildren(meta, this.children, newElem.children);\n        }\n\n        return newElem;\n    }\n\n    targetRender(meta: ContextMeta): TargetNode[] {\n        const t = meta.target;\n        const [\n            elem,\n            selfTargetMeta,\n            nestedTargetMeta\n        ] = t.create(meta.targetMeta, this.tagName);\n        const nestedMeta = {\n            ...meta,\n            targetMeta: nestedTargetMeta\n        };\n        const selfMeta = {\n            ...meta,\n            targetMeta: selfTargetMeta\n        };\n        this.targetNode = elem;\n        this.initAttrs(selfMeta);\n        this.setChildren(selfMeta, nestedMeta);\n        this.targetNodes = [this.targetNode];\n        return this.targetNodes;\n    }\n\n    free() {\n        this.hs.free();\n        this.children.forEach(child => child.free());\n    }\n}\n\n\nexport function registerGlobalProp<T>(matcher: string, handler: RefHandler<T>) {\n    refProps[matcher] = handler;\n}\n\nregisterGlobalProp('ref', ({owner, value}) => {\n    (value as Ref)(owner);\n});\n","import {HvNode, ContextMeta, AbstractElement} from './blocks/abstract';\nimport {flatArray} from './utils';\n\nexport interface MergeHandlers {\n    appendChild(child: HvNode): void;\n    removeChild(child: HvNode): void;\n    replaceChild(oldChild: HvNode, newChild: HvNode): void;\n}\n\nexport function mergeChildren(meta: ContextMeta, oldChildren: HvNode[], newChildren: HvNode[]): AbstractElement[] {\n    const preparedChildren: HvNode[] = newChildren.map((newChild, index) => {\n        const oldChild = oldChildren[index];\n\n        if (!oldChild) {\n            return newChild;\n        }\n\n        if (oldChild.constructor !== newChild.constructor) {\n            return newChild;\n        }\n\n        return oldChild.merge(meta, newChild);\n    });\n\n    const [oldNodes, newNodes] = [oldChildren, preparedChildren].map(children => {\n        return flatArray(children.map(child => child.targetNodes || child.targetRender(meta)));\n    });\n\n    meta.target.replaceSequence(meta.targetMeta, oldNodes, newNodes);\n\n    return preparedChildren;\n}\n","import {HyperValue, scopes} from 'hyper-value';\nimport {normalizeNodeSet} from './common';\nimport {AbstractElement, HvNode, ContextMeta, TargetNode, Children} from './abstract';\nimport {flatArray} from '../utils';\nimport {renderDebug} from '../debug';\nimport {mergeChildren} from '../merge';\nimport {hashBlock, hash} from '../hash';\n\nexport class HyperZone extends AbstractElement {\n    content: HyperValue<HvNode[]>;\n    private hs = new scopes.FullScope();\n\n    constructor (content: HyperValue<Children>) {\n        super();\n        this.content = this.hs.proxy(content, content => normalizeNodeSet(this.hs, content));\n        this.hash = hashBlock({\n            type: 'HyperZone',\n            content: hash(content)\n        });\n    }\n\n    @renderDebug\n    private getTargetNodes(meta: ContextMeta, elems: HvNode[], needRender: boolean): TargetNode[] {\n        return flatArray<TargetNode>(elems.map(elem => {\n            return needRender\n                ? elem.targetRender(meta)\n                : elem.targetNodes;\n        }));\n    }\n\n    private mergeChildren(meta: ContextMeta, newElems: HvNode[], oldElems: HvNode[]) {\n        mergeChildren(meta, oldElems, newElems);\n    }\n\n    targetRender(meta: ContextMeta): TargetNode[] {\n        // const t = meta.target;\n\n        this.hs.watch(this.content, (newElems, oldElems) => {\n            this.mergeChildren(meta, newElems, oldElems);\n            // const oldContent = this.getTargetNodes(meta, oldElems, false);\n            // let i = oldElems.length;\n            // while (i--) {\n            //     oldElems[i].free();\n            // }\n            // const newContent = this.getTargetNodes(meta, newElems, true);\n            // t.replaceSequence(meta.targetMeta, oldContent, newContent);\n        });\n\n        this.targetNodes = this.getTargetNodes(meta, this.content.g(), true);\n        return this.targetNodes;\n    }\n\n    free() {\n        this.hs.free();\n        this.content.$.forEach(child => child.free());\n    }\n\n    merge(meta: ContextMeta, newZone: HyperZone): HyperZone {\n        if (this.hash === newZone.hash) {\n            return this;\n        }\n\n        return newZone;\n    }\n}\n","import {HyperValue, scopes} from 'hyper-value';\nimport {FSType} from 'hyper-value/types/scopes/full';\n\nimport {renderDebug} from '../debug';\n\nimport {\n    PropsAbstract,\n    HvNode,\n    ContextMeta,\n    TargetNode,\n    TargetMock,\n    TargetMeta,\n    AbstractElement,\n    Children\n} from './abstract';\n\nimport {\n    normalizeNodeSet,\n} from './common';\n\nimport {HyperZone} from './zone';\n\nimport {hashBlock, hashDict} from '../hash';\n\nexport let componentTable: Component<any>[] = [];\n\nexport interface FunctionComponent<P extends PropsAbstract> {\n    (props: P, children: Children): Children;\n}\n\nfunction injectId(id: number) {\n    return (attrs: PropsAbstract) => {\n        if (!('id' in attrs)) {\n            return attrs;\n        }\n        const newAttrs: PropsAbstract = {\n            ...attrs,\n            'data-hv-id': id + ':' + attrs.id\n        };\n        // todo consider me\n        // delete newAttrs.id;\n        return newAttrs;\n    };\n}\n\nexport abstract class Component<P extends PropsAbstract> extends AbstractElement {\n    static hvComponent = true;\n\n    private renderHs: FSType = new scopes.FullScope();\n    hs: FSType = new scopes.FullScope();\n    hv!: HyperValue<Children>;\n    children: HvNode[];\n    props: P;\n    id: number;\n    // domEe: DomEventEmitter;\n\n    constructor (props: P, children: Children) {\n        super();\n        this.children = normalizeNodeSet(this.hs, children);\n        this.props = props;\n        this.id = componentTable.length;\n        componentTable.push(this);\n\n        this.hash = hashBlock({\n            type: 'component',\n            props: hashDict(props),\n            children: this.children.map(child => child.hash)\n        });\n        // this.domEe = new DomEventEmitter();\n    }\n\n    init() {}\n\n    free() {\n        this.hs.free();\n        this.children.forEach(child => child.free());\n    }\n\n    private mockHs<T>(fn: () => T): T {\n        this.renderHs.free();\n        this.renderHs = new scopes.FullScope();\n        const hsBackup = this.hs;\n        this.hs = this.renderHs;\n        const result = fn();\n        this.hs = hsBackup;\n        return result;\n    }\n\n    @renderDebug\n    targetRender(meta: ContextMeta): TargetNode[] {\n        this.init();\n        const t = meta.target;\n        const domHv = this.hs.auto(() => {\n            return this.mockHs(() => this.render());\n        });\n        const domZone = new HyperZone(domHv);\n        this.targetNodes = domZone.targetRender({\n            ...meta,\n            mapAttrs: injectId(this.id)\n        });\n        for (let elem of this.targetNodes) {\n            t.setData(meta.targetMeta, elem, {\n                compId: this.id\n            });\n        }\n        return this.targetNodes;\n    }\n\n    merge(meta: ContextMeta, newComp: Component<P>): Component<P> {\n        return newComp;\n    }\n\n    // on(eventType: string, targetId: string, handler: DomEventHandler) {\n    //     this.domEe.listen(eventType, targetId, handler);\n\n    // }\n\n    abstract render(): Children;\n}\n\nexport type CustomComponent<P> = {\n    new (props: PropsAbstract, children: (HvNode | string)[]): Component<P>;\n};\n\nexport function isComponentClass(fn: CustomComponent<any>): boolean {\n    return (fn as any).hvComponent === true;\n}\n\nexport function closestComponent<T extends Component<any>>(targetMeta: TargetMeta, target: TargetMock, node: TargetNode): T | null {\n    const found = target.closest(targetMeta, node, node => {\n        const data = target.getData(targetMeta, node);\n        return data.compId !== undefined;\n    });\n\n    if (!found) {\n        return null;\n    }\n\n    const id = target.getData(targetMeta, found).compId;\n    return componentTable[Number(id)] as T;\n}\n","import {HyperValue} from '../core/core';\nimport {ProxyScope} from './proxy';\n\nexport class ObjectScope extends ProxyScope {\n    prop<T extends object, K extends keyof T>(hv: HyperValue<T>, propertyName: K): HyperValue<T[K]> {\n        return this.proxy(\n            hv,\n            () => hv.$[propertyName],\n            value => {\n                return {\n                    ...hv.$ as object,\n                    [propertyName]: value\n                } as T;\n            }\n        );\n    }\n\n    setProp<T>(hv: HyperValue<T[]>, propertyName: number, value: T): void;\n    setProp<T extends object, K extends keyof T>(hv: HyperValue<T>, propertyName: K, value: T[K]): void;\n    setProp<T extends object, K extends keyof T>(hv: HyperValue<T>, propertyName: K, value: T[K]) {\n        const obj = hv.$;\n        obj[propertyName] = value;\n        hv.$ = obj;\n    }\n\n    getProp<T>(hv: HyperValue<T[]>, propertyName: number): T;\n    getProp<T extends object, K extends keyof T>(hv: HyperValue<T>, propertyName: K): T[K];\n    getProp<T extends object, K extends keyof T>(hv: HyperValue<T>, propertyName: K): T[K] {\n        return hv.$[propertyName];\n    }\n}\n","import {HyperValue, recordAsync, PromiseWrapper} from '../core';\nimport {BaseScope} from './base';\n\ninterface Dep {\n    watcherId: number;\n    hvId: number;\n}\n\nexport interface HvAsyncParams<T, I> {\n    initial?: I;\n    get?: AsyncGetter<T>;\n    set?: AsyncSetterApprove<T>;\n    update?: AsyncSetter<T>;\n}\n\nexport class HvAsync<T, I> extends HyperValue<T | I> {\n    state = new HyperValue('resolved') as HyperValue<'pending' | 'resolved' | 'rejected'>;\n    private getter: AsyncGetter<T> | undefined;\n    private setter: AsyncSetter<T> | undefined;\n    private hs: BaseScope;\n    private callId = 0;\n    private currentPromise: Promise<T>;\n    private resolver: () => void;\n    private rejecter: (error: Error) => void;\n\n    constructor(hs: BaseScope, params: HvAsyncParams<T, I>) {\n        super(params.initial as I);\n        this.hs = hs;\n        this.getter = params.get;\n        if (params.set && params.update) {\n            throw new Error('both set and update cannot be defined');\n        }\n        if (params.update) {\n            this.setter = params.update;\n        }\n        if (params.set) {\n            this.setter = value => {\n                const setter = params.set as AsyncSetterApprove<T>;\n                return setter(value).then(() => value);\n            };\n        }\n        this.initPromise();\n        this.init();\n    }\n\n    private initPromise() {\n        this.currentPromise = new Promise((resolve, reject) => {\n            this.resolver = resolve;\n            this.rejecter = reject;\n        });\n    }\n\n    private fetch(fn: () => Promise<T>): Promise<T> {\n        return new Promise((resolve, reject) => {\n            this.callId++;\n            const id = this.callId;\n\n            this.state.$ = 'pending';\n\n            fn().then(\n                value => {\n                    if (this.callId === id) {\n                        super.s(value);\n                        this.state.$ = 'resolved';\n                        this.resolver();\n                        this.initPromise();\n                    }\n\n                    resolve(value);\n                },\n                error => {\n                    if (this.callId === id) {\n                        this.state.$ = 'rejected';\n                        this.rejecter(error);\n                        this.initPromise();\n                        this.hs.fail(this, error);\n                    }\n\n                    reject(error);\n                }\n            );\n        });\n    }\n\n    wait(): Promise<HvAsync<T, T>> {\n        return this.currentPromise.then(() => this as any as HvAsync<T, T>);\n    }\n\n    private init() {\n        if (!this.getter) {\n            return;\n        }\n\n        let depList = [] as Dep[];\n\n        const watchDeps = (hvIdList: number[]) => {\n            return hvIdList.map(hvId => {\n                return {\n                    hvId,\n                    watcherId: this.hs.watch(hvId, watcher)\n                };\n            });\n        };\n\n        const watcher = () => {\n            for (const dep of depList) {\n                this.hs.unwatch(dep.hvId, dep.watcherId);\n            }\n\n            recordAsync(w => {\n                const getter = this.getter as AsyncGetter<T>;\n                return this.fetch(() => getter(w));\n            }, deps => {\n                depList = depList.concat(watchDeps(deps.map(hv => hv.id)));\n            })\n            .catch(() => {\n                depList = watchDeps(depList.map(dep => dep.hvId));\n            });\n        };\n\n        watcher();\n    }\n\n    s(newValue: T) {\n        if (!this.setter) {\n            super.s(newValue);\n            return;\n        }\n\n        this.fetch(() => {\n            return (this.setter as AsyncSetter<T>)(newValue);\n        }).then(value => {\n            super.s(value);\n        });\n    }\n}\n\nexport interface AsyncGetter<T> {\n    (w: PromiseWrapper): Promise<T>;\n}\n\nexport interface AsyncSetter<T> {\n    (value: T): Promise<T>;\n}\n\nexport interface AsyncSetterApprove<T> {\n    (value: T): Promise<void>;\n}\n\nexport class AsyncScope extends BaseScope {\n    async<T, I = undefined>(params: HvAsyncParams<T, I>): HvAsync<T, I> {\n        return new HvAsync(this, params);\n    }\n}\n","export interface Mixin<C1, C2> {\n    new (...args: any[]): C1 & C2;\n}\nexport type Constructor<T = {}> = new (...args: any[]) => T;\n\nfunction assignProps(dstObj: any, srcObj: any) {\n    Object.getOwnPropertyNames(srcObj).forEach(name => {\n        dstObj[name] = srcObj[name];\n    });\n}\n\nfunction getPrototypeChain(baseProto: any) {\n    let res: any[] = [];\n\n    while (true) {\n        const proto = Object.getPrototypeOf(baseProto);\n        if (!proto || proto === Object.prototype) {\n            break;\n        }\n        res.push(proto);\n        baseProto = proto;\n    }\n\n    res.reverse();\n    return res;\n}\n\nexport function mix<BC, C>(baseClass: Constructor<BC>, mixClass: Constructor<C>) {\n    class NewClass extends (baseClass as Constructor<{}>) {\n        constructor (...args: any[]) {\n            super(...args);\n        }\n    }\n\n    [baseClass, mixClass].forEach(baseCtor => {\n        const protos = [baseCtor.prototype, ...getPrototypeChain(baseCtor.prototype)];\n        protos.forEach(proto => assignProps(NewClass.prototype, proto));\n    });\n\n    return NewClass as any as Mixin<BC, C>;\n}\n\nexport function mixSome(...classes: Constructor<any>[]) {\n    let result = classes[0];\n\n    classes.slice(1).forEach(ctor => {\n        result = mix(result, ctor);\n    });\n\n    return result;\n}\n","import {HyperValue} from '../core/core';\nimport {AutoScope} from './auto';\nimport {CastScope} from './cast';\nimport {mixSome, Mixin} from '../utils/mixin';\n\nexport interface IteratorFn<T, R> {\n    (value: T, index: number, array: T[]): R;\n}\n\nexport interface Reducer<T, R> {\n    (acc: R, value: T, index: number, array: T[]): R;\n}\n\nexport const Base = mixSome(AutoScope, CastScope) as Mixin<AutoScope, CastScope>;\n\nexport class ArrayScope extends Base {\n    length(hv: HyperValue<any[]>): HyperValue<number> {\n        return this.auto(() => {\n            return hv.$.length;\n        });\n    }\n\n    map<T, R>(hv: HyperValue<T[]>, mapFn: IteratorFn<T, R>): HyperValue<R[]> {\n        return this.auto(() => {\n            return hv.$.map(mapFn);\n        });\n    }\n\n    every<T>(hv: HyperValue<T[]>, mapFn: IteratorFn<T, boolean>): HyperValue<boolean> {\n        return this.auto(() => {\n            return hv.$.every(mapFn);\n        });\n    }\n\n    some<T>(hv: HyperValue<T[]>, mapFn: IteratorFn<T, boolean>): HyperValue<boolean> {\n        return this.auto(() => {\n            return hv.$.some(mapFn);\n        });\n    }\n\n    filter<T>(hv: HyperValue<T[]>, mapFn: IteratorFn<T, boolean>): HyperValue<T[]> {\n        return this.auto(() => {\n            return hv.$.filter(mapFn);\n        });\n    }\n\n    reduce<T>(hv: HyperValue<T[]>, reducer: Reducer<T, T>): HyperValue<T>;\n\n    reduce<T, R>(hv: HyperValue<T[]>, reducer: Reducer<T, R>, initial: R): HyperValue<R>;\n\n    reduce<T, R>(hv: HyperValue<T[]>, reducer: Reducer<T, R>, initial?: R): HyperValue<R> {\n        return this.auto(() => {\n            return initial !== undefined\n                ? hv.$.reduce(reducer, initial)\n                : hv.$.reduce(reducer as any as Reducer<T, T>) as any as R;\n        });\n    }\n\n    find<T>(hv: HyperValue<T[]>, fn: IteratorFn<T, boolean>): HyperValue<T | null> {\n        return this.auto(() => {\n            const array = hv.$;\n            for (let i = 0; i < array.length; i++) {\n                if (fn(array[i], i, array)) {\n                    return array[i];\n                }\n            }\n            return null;\n        });\n    }\n\n    findIndex<T>(hv: HyperValue<T[]>, fn: IteratorFn<T, boolean>): HyperValue<number | null> {\n        return this.auto(() => {\n            const array = hv.$;\n            for (let i = 0; i < array.length; i++) {\n                if (fn(array[i], i, array)) {\n                    return i;\n                }\n            }\n            return -1;\n        });\n    }\n\n    concat<T1>(hv1: HyperValue<T1[]>): HyperValue<T1[]>;\n    concat<T1, T2>(hv1: HyperValue<T1[]>, hv2: HyperValue<T2[]>): HyperValue<(T1 | T2)[]>;\n    concat<T1, T2, T3>(hv1: HyperValue<T1[]>, hv2: HyperValue<T2[]>, hv3: HyperValue<T2[]>): HyperValue<(T1 | T2 | T3)[]>;\n\n    concat(...hvs: HyperValue<any[]>[]): HyperValue<any[]> {\n        return this.auto(() => {\n            const arrays = hvs.map(hv => hv.$);\n            return Array.prototype.concat.apply([], [...arrays]);\n        });\n    }\n\n    slice<T>(hv: HyperValue<T[]>, start?: number | HyperValue<number>, end?: number | HyperValue<number>): HyperValue<T[]> {\n        return this.auto(() => {\n            const array = hv.$;\n            const s = start === undefined ? 0 : this.read(start);\n            const e = end === undefined ? array.length : this.read(end);\n            return array.slice(s, e);\n        });\n    }\n\n    insert<T>(hv: HyperValue<T[]>, index: number, elems: T | T[]) {\n        const array = hv.$;\n        if (index < 0) {\n            index = array.length + index;\n        }\n        const newArray = ([] as T[]).concat(\n            array.slice(0, index),\n            elems,\n            array.slice(index)\n        );\n        hv.$ = newArray;\n    }\n\n    remove(hv: HyperValue<any[]>, index: number, length: number) {\n        const array = hv.$;\n        if (index < 0) {\n            index = array.length + index;\n        }\n        const newArray = ([] as any[]).concat(array.slice(0, index), array.slice(index + length));\n        hv.$ = newArray;\n    }\n\n    sort<T>(hv: HyperValue<T[]>, sortFn?: (a: T, b: T) => number): HyperValue<T[]> {\n        return this.auto(() => {\n            const array = hv.$.slice();\n            array.sort(sortFn);\n            return array;\n        });\n    }\n\n}\n","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\r\n} catch (e) {\r\n\t// This works if the window reference is available\r\n\tif (typeof window === \"object\") g = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n","import {List, IdDict} from '../utils/list';\n\nexport interface WatcherFn<T> {\n    (newValue: T, oldValue: T): void;\n}\n\nexport interface Catcher {\n    (error: Error, details: ErrorDetails): void;\n}\n\ninterface HvData {\n    watchers: List<WatcherFn<any>>;\n    catcher: Catcher | null;\n}\n\nexport interface ErrorDetails {\n    oldValue?: any;\n    newValue?: any;\n}\n\nexport class HvDispatcher {\n    private watcherSets: IdDict<HvData> = {};\n    private lastErrorDetails: ErrorDetails | null = null;\n\n    watch(hvId: number, fn: WatcherFn<any>): number {\n        let currentSet = this.watcherSets[hvId];\n        if (!currentSet) {\n            currentSet = {\n                watchers: new List(),\n                catcher: null\n            };\n            this.watcherSets[hvId] = currentSet;\n        }\n        return currentSet.watchers.add(fn);\n    }\n\n    unwatch(hvId: number, watcherId: number) {\n        let currentSet = this.watcherSets[hvId];\n        if (!currentSet) {\n            throw new Error('incorrect hv ID');\n        }\n        currentSet.watchers.del(watcherId);\n    }\n\n    catch(hvId: number, catcher: Catcher) {\n        let currentSet = this.watcherSets[hvId];\n        if (!currentSet) {\n            currentSet = {\n                watchers: new List(),\n                catcher: null\n            };\n            this.watcherSets[hvId] = currentSet;\n        }\n        currentSet.catcher = catcher;\n    }\n\n    handle(hvId: number, newValue: any, oldValue: any) {\n        let currentSet = this.watcherSets[hvId];\n        if (!currentSet) {\n            return;\n        }\n        currentSet.watchers.entries().forEach(([, watcher]) => {\n            try {\n                watcher(newValue, oldValue);\n            } catch (error) {\n                this.lastErrorDetails = {newValue, oldValue};\n                this.fail(hvId, error);\n            }\n        });\n    }\n\n    fail(hvId: number, error: Error, details?: ErrorDetails) {\n        let currentSet = this.watcherSets[hvId];\n        if (!currentSet) {\n            throw error;\n        }\n\n        if (currentSet.catcher) {\n            details = details || this.lastErrorDetails as ErrorDetails;\n            currentSet.catcher(error, details);\n            this.lastErrorDetails = null;\n            return;\n        }\n\n        throw error;\n    }\n}\n\nexport const globalDispatcher = new HvDispatcher();\n","import {HyperValue} from './core';\n\nexport let recordedHvStack: HyperValue<any>[][] = [];\n\nexport interface WatcherFn<T> {\n    (newValue: T, oldValue: T): void;\n}\n\nexport type WatcherId = number;\n\nfunction hvRecordStart() {\n    recordedHvStack.push([]);\n}\n\nfunction hvRecordStop(): HyperValue<any>[] {\n    const newList = recordedHvStack.pop();\n    return newList as HyperValue<any>[];\n}\n\nexport function addToRecords(hv: HyperValue<any>) {\n    if (recordedHvStack.length <= 0) {\n        return;\n    }\n    const currentList = recordedHvStack[recordedHvStack.length - 1];\n    if (currentList.indexOf(hv) === -1) {\n        currentList.push(hv);\n    }\n}\n\nexport function record<T>(fn: () => T): [T, HyperValue<any>[]] {\n    hvRecordStart();\n    const result = fn();\n    return [result, hvRecordStop()];\n}\n\nexport type PromiseWrapper = <T>(p: Promise<T>) => Promise<T>;\n\nexport function recordAsync<T>(\n    fn: (w: PromiseWrapper) => Promise<T>,\n    noNewDeps?: (deps: HyperValue<any>[]) => void\n): Promise<[T, HyperValue<any>[]]> {\n\n    return new Promise((resolve, reject) => {\n        let deps = [] as HyperValue<any>[];\n\n        function w<T>(p: Promise<T>): Promise<T> {\n            return new Promise((resolve, reject) => {\n                const newDeps = hvRecordStop();\n\n                deps = deps.concat(newDeps);\n                if (noNewDeps) {\n                    noNewDeps(newDeps);\n                }\n\n                p.then(\n                    value => {\n                        hvRecordStart();\n                        resolve(value);\n                    },\n                    error => {\n                        reject(error);\n                    }\n                );\n            });\n        }\n\n        hvRecordStart();\n        fn(w).then(\n            value => {\n                const newDeps = hvRecordStop();\n                const finalDeps = [...deps, ...newDeps];\n\n                if (noNewDeps) {\n                    noNewDeps(newDeps);\n                }\n\n                resolve([value, finalDeps]);\n            },\n            error => {\n                reject(error);\n            }\n        );\n\n    });\n}\n","import {addToRecords} from './record';\nimport {globalDispatcher} from './dispatcher';\nimport { traceHv} from '../debug';\n\nlet currentId = 0;\n\n//@hvDebug\nexport class HyperValue<T> {\n    private value: T;\n    private newValue: T;\n    private updating = false;\n    id = currentId++;\n\n    constructor(initialValue: T) {\n        this.value = initialValue;\n    }\n\n    g(silent?: boolean): T {\n        if (!silent) {\n            addToRecords(this);\n        }\n        if (this.updating) {\n            return this.newValue;\n        }\n        return this.value;\n    }\n\n    @traceHv\n    s(newValue: T) {\n        if (this.updating) {\n            return;\n        }\n\n        if (newValue === this.value) {\n            return;\n        }\n\n        this.updating = true;\n\n        this.newValue = newValue;\n\n        globalDispatcher.handle(this.id, newValue, this.value);\n\n        this.value = newValue;\n\n        this.updating = false;\n    }\n\n    get $() {\n        return this.g();\n    }\n\n    set $(newValue: T) {\n        this.s(newValue);\n    }\n\n}\n","export type DomNode = Text | Element | null;\nexport type XmlNamespace = 'html' | 'svg';\n\ninterface XmlNamespaces {\n    selfNs: XmlNamespace;\n    childNs: XmlNamespace;\n}\n\nconst nsTable = {\n    html: 'http://www.w3.org/1999/xhtml',\n    svg: 'http://www.w3.org/2000/svg'\n};\n\nexport interface Meta {\n    ns: XmlNamespace;\n}\n\nexport interface Data {\n    [key: string]: any;\n}\n\nexport function append(meta: Meta, parentMeta: Meta, parent: DomNode, elm: DomNode) {\n    if (elm === null || parent === null) {\n        return;\n    }\n    parent.appendChild(elm);\n}\n\nexport function appendSequence(meta: Meta, parentMeta: Meta, parent: DomNode, elems: DomNode[]) {\n    if (elems.length <= 0 || parent === null) {\n        return;\n    }\n\n    for (let elem of elems) {\n        if (!elem) {\n            throw new Error('empty child');\n        }\n\n        parent.appendChild(elem);\n    }\n}\n\nexport function closest(meta: Meta, from: DomNode, matcher: (elem: DomNode) => boolean): DomNode {\n    let elem = from;\n\n    while (elem) {\n        if (matcher(elem)) {\n            return elem;\n        }\n        elem = elem.parentElement;\n    }\n\n    return null;\n}\n\nexport function create(meta: Meta, tagName: string): [DomNode, Meta, Meta] {\n    const {childNs, selfNs} = guessNs(tagName, meta.ns);\n    const elem = document.createElementNS(nsTable[selfNs], tagName);\n    const nestedMeta: Meta = {\n        ...meta,\n        ns: childNs\n    };\n    const selfMeta: Meta = {\n        ...meta,\n        ns: selfNs\n    };\n    return [elem, selfMeta, nestedMeta];\n}\n\nexport function createPlaceholder(meta: Meta): DomNode {\n    const elem = meta.ns === 'html'\n        ? document.createElementNS(nsTable.html, 'script')\n        : document.createElementNS(nsTable.svg, 'g');\n    return elem;\n}\n\nexport function createTextNode(meta: Meta, text: string): DomNode {\n    return document.createTextNode(text);\n}\n\nexport function getData(meta: Meta, elem: DomNode): Data {\n    if (!elem) {\n        return {};\n    }\n    return (elem as HTMLElement).dataset;\n}\n\nexport function remove(meta: Meta, elem: DomNode) {\n    if (!elem) {\n        throw new Error('empty child');\n    }\n\n    const parent = elem.parentElement;\n\n    if (!parent) {\n        throw new Error('not mounted');\n    }\n\n    parent.removeChild(elem);\n}\n\nexport function replace(meta: Meta, oldElem: DomNode, newElm: DomNode): any {\n    if (!oldElem) {\n        return;\n    }\n\n    if (!newElm) {\n        oldElem.remove();\n    }\n\n    const parent = oldElem.parentElement;\n\n    if (!parent) {\n        throw new Error('cannot replace dom');\n    }\n\n    parent.replaceChild(newElm as HTMLElement, oldElem as HTMLElement);\n}\n\nexport function replaceSequence(meta: Meta, oldElems: DomNode[], newElms: DomNode[]): any {\n    const lastOld = oldElems[oldElems.length - 1];\n\n    if (!lastOld) {\n        throw new Error('no placeholder');\n    }\n\n    const parent = lastOld.parentElement;\n    const nextSibling = lastOld.nextSibling;\n\n    if (!parent) {\n        throw new Error('no parent');\n    }\n\n    for (let elem of oldElems) {\n        remove(meta, elem);\n    }\n\n    for (let elem of newElms) {\n        if (!elem) {\n            throw new Error('empty child');\n        }\n        if (nextSibling) {\n            parent.insertBefore(elem, nextSibling);\n        } else {\n            parent.appendChild(elem);\n        }\n    }\n}\n\nexport function setData(meta: Meta, elem: DomNode, value: Data) {\n    if (!elem) {\n        return;\n    }\n\n    const dataset = (elem as HTMLElement).dataset;\n\n    for (let name in value) {\n        dataset[name] = value[name];\n    }\n}\n\nexport function setProp(meta: Meta, elem: DomNode, name: string, value: any) {\n    if (!elem || elem instanceof Text) {\n        throw new Error('cannot set property of null');\n    }\n\n    if (meta.ns === 'html' && name in elem) {\n        (elem as any)[name] = value;\n        return;\n    }\n\n    elem.setAttribute(name, value);\n}\n\nfunction guessNs(tagName: string, currentNs: XmlNamespace): XmlNamespaces {\n    if (tagName === 'svg') {\n        return {\n            selfNs: 'svg',\n            childNs: 'svg'\n        };\n    }\n    if (tagName === 'foreignObject') {\n        return {\n            selfNs: 'svg',\n            childNs: 'html'\n        };\n    }\n    return {\n        selfNs: currentNs,\n        childNs: currentNs\n    };\n}\n","import {HyperValue, scopes} from 'hyper-value';\n\nimport {registerGlobalProp} from 'hv-jsx';\n\nexport type EveryStyleProp = keyof CSSStyleDeclaration;\n\nexport type StyleDict = {\n    [key in EveryStyleProp]?: string | null | HyperValue<string | null>;\n};\n\nexport type StyleProp = StyleDict | HyperValue<StyleDict>;\n\nregisterGlobalProp<StyleProp>('style', ({owner, hs, name, value}) => {\n    const elem = owner.targetNode as HTMLElement;\n\n    const styleHv = hs.cast(value);\n    hs.auto(() => {\n        const styles = styleHv.$;\n        for (const name in styles) {\n            const value = styles[name as keyof StyleDict];\n\n            if (value === undefined) {\n                continue;\n            }\n            (elem.style as any)[name] = hs.read(value);\n        }\n    });\n});\n","import {registerGlobalProp} from 'hv-jsx';\nimport {Events} from './eventTypes';\n\nconst eventNames = [\n    // Clipboard Events\n    'onCopy',\n    'onCopyCapture',\n    'onCut',\n    'onCutCapture',\n    'onPaste',\n    'onPasteCapture',\n\n    // Composition Events\n    'onCompositionEnd',\n    'onCompositionEndCapture',\n    'onCompositionStart',\n    'onCompositionStartCapture',\n    'onCompositionUpdate',\n    'onCompositionUpdateCapture',\n\n    // Focus Events\n    'onFocus',\n    'onFocusCapture',\n    'onBlur',\n    'onBlurCapture',\n\n    // Form Events\n    'onChange',\n    'onChangeCapture',\n    'onInput',\n    'onInputCapture',\n    'onReset',\n    'onResetCapture',\n    'onSubmit',\n    'onSubmitCapture',\n    'onInvalid',\n    'onInvalidCapture',\n\n    // Image Events\n    'onLoad',\n    'onLoadCapture',\n    'onError',\n    'onErrorCapture',\n\n    // Keyboard Events\n    'onKeyDown',\n    'onKeyDownCapture',\n    'onKeyPress',\n    'onKeyPressCapture',\n    'onKeyUp',\n    'onKeyUpCapture',\n\n    // Media Events\n    'onAbort',\n    'onAbortCapture',\n    'onCanPlay',\n    'onCanPlayCapture',\n    'onCanPlayThrough',\n    'onCanPlayThroughCapture',\n    'onDurationChange',\n    'onDurationChangeCapture',\n    'onEmptied',\n    'onEmptiedCapture',\n    'onEncrypted',\n    'onEncryptedCapture',\n    'onEnded',\n    'onEndedCapture',\n    'onLoadedData',\n    'onLoadedDataCapture',\n    'onLoadedMetadata',\n    'onLoadedMetadataCapture',\n    'onLoadStart',\n    'onLoadStartCapture',\n    'onPause',\n    'onPauseCapture',\n    'onPlay',\n    'onPlayCapture',\n    'onPlaying',\n    'onPlayingCapture',\n    'onProgress',\n    'onProgressCapture',\n    'onRateChange',\n    'onRateChangeCapture',\n    'onSeeked',\n    'onSeekedCapture',\n    'onSeeking',\n    'onSeekingCapture',\n    'onStalled',\n    'onStalledCapture',\n    'onSuspend',\n    'onSuspendCapture',\n    'onTimeUpdate',\n    'onTimeUpdateCapture',\n    'onVolumeChange',\n    'onVolumeChangeCapture',\n    'onWaiting',\n    'onWaitingCapture',\n\n    // MouseEvents\n    'onClick',\n    'onClickCapture',\n    'onContextMenu',\n    'onContextMenuCapture',\n    'onDblClick',\n    // 'onDoubleClickCapture',\n    'onDrag',\n    'onDragCapture',\n    'onDragEnd',\n    'onDragEndCapture',\n    'onDragEnter',\n    'onDragEnterCapture',\n    'onDragExit',\n    'onDragExitCapture',\n    'onDragLeave',\n    'onDragLeaveCapture',\n    'onDragOver',\n    'onDragOverCapture',\n    'onDragStart',\n    'onDragStartCapture',\n    'onDrop',\n    'onDropCapture',\n    'onMouseDown',\n    'onMouseDownCapture',\n    'onMouseEnter',\n    'onMouseLeave',\n    'onMouseMove',\n    'onMouseMoveCapture',\n    'onMouseOut',\n    'onMouseOutCapture',\n    'onMouseOver',\n    'onMouseOverCapture',\n    'onMouseUp',\n    'onMouseUpCapture',\n\n    // Selection Events\n    'onSelect',\n    'onSelectCapture',\n\n    // Touch Events\n    'onTouchCancel',\n    'onTouchCancelCapture',\n    'onTouchEnd',\n    'onTouchEndCapture',\n    'onTouchMove',\n    'onTouchMoveCapture',\n    'onTouchStart',\n    'onTouchStartCapture',\n\n    // UI Events\n    'onScroll',\n    'onScrollCapture',\n\n    // Wheel Events\n    'onWheel',\n    'onWheelCapture',\n\n    // Animation Events\n    'onAnimationStart',\n    'onAnimationStartCapture',\n    'onAnimationEnd',\n    'onAnimationEndCapture',\n    'onAnimationIteration',\n    'onAnimationIterationCapture',\n\n    // Transition Events\n    'onTransitionEnd',\n    'onTransitionEndCapture',\n];\n\neventNames.forEach(event => {\n    registerGlobalProp(event, ({owner, hs, name, value}) => {\n        const elem = owner.targetNode as HTMLElement;\n        (elem as any)[name.toLowerCase()] = value;\n    });\n});\n\ndeclare global {\n    namespace JSX {\n        interface GlobalProps extends Events {}\n    }\n}\n","import {\n    Target,\n    ContextMeta,\n    Children,\n    targetRenderChildren,\n    closestComponent as jsxClosestComponent,\n    Component,\n    debugTargetProxy,\n} from 'hv-jsx';\n\nimport './events';\n\nimport {Tags} from './domTypes';\n\nimport {Meta, DomNode, Data, XmlNamespace} from './domHelpers';\n\nimport './style';\n\nimport {\n    append,\n    appendSequence,\n    closest,\n    create,\n    createPlaceholder,\n    createTextNode,\n    getData,\n    // remove,\n    replaceSequence,\n    replace,\n    setData,\n    setProp\n} from './domHelpers';\n\n\nexport const dom: Target<DomNode, Meta, number, Data> = {\n    append,\n    closest,\n    create,\n    createPlaceholder,\n    createTextNode,\n    getData,\n    // remove,\n    replaceSequence,\n    replace,\n    setData,\n    setProp\n};\n\nexport const defaultTargetMeta: Meta = {\n    ns: 'html'\n};\n\nexport interface MetaParams {\n    ns?: XmlNamespace;\n}\n\nexport function renderDom(jsx: Children, params: MetaParams = {}): DomNode[] {\n    const contextMeta: ContextMeta = {\n        target: debugTargetProxy(dom),\n        targetMeta: defaultTargetMeta\n    } as any as ContextMeta;\n\n    return targetRenderChildren(contextMeta, jsx) as DomNode[];\n}\n\nexport function renderIn(where: HTMLElement, params: MetaParams, jsx: Children) {\n    where.innerHTML = '';\n\n    const content = renderDom(jsx, params);\n\n    appendSequence(defaultTargetMeta, defaultTargetMeta, where, content);\n}\n\nexport function closestComponent<T extends Component<any>>(elem: DomNode): T | null {\n    return jsxClosestComponent(defaultTargetMeta, dom, elem);\n}\n\ndeclare global {\n    namespace JSX {\n        interface IntrinsicElements extends Tags {}\n    }\n}\n","import {HvNode, Props, Ref, Children} from './blocks/abstract';\nimport {HyperElm} from './blocks/element';\nimport {CustomComponent, Component, isComponentClass, FunctionComponent} from './blocks/component';\n\ndeclare global {\n    namespace JSX {\n        interface Element extends HvNode {}\n\n        interface ElementClass<P> {\n            render: () => Children;\n        }\n\n        interface ElementAttributesProperty {\n            props: any;\n        }\n\n        interface IntrinsicProps extends GlobalProps {\n            ref?: Ref;\n        }\n\n        interface IntrinsicElements {\n            [key: string]: IntrinsicProps;\n        }\n\n        interface GlobalProps {\n\n        }\n    }\n}\n\nexport function jsx<P extends Props>(what: string | CustomComponent<P> | FunctionComponent<P>, props: P, ...children: HvNode[]): Component<P> | HvNode {\n    if (props === null) {\n        props = {} as P;\n    }\n\n    if (typeof what === 'string') {\n        return new HyperElm(what, props, children);\n    }\n\n    if (isComponentClass(what as CustomComponent<P>)) {\n        const ComponentClass = what as CustomComponent<P>;\n        return new ComponentClass(props, children);\n    }\n\n    const fc = what as FunctionComponent<P>;\n    return jsx(class FC extends Component<P> {\n        render() {\n            return fc(this.props, this.children);\n        }\n    }, props, ...children);\n}\n\nexport type JsxFn = typeof jsx;\n\n","import {AbstractElement, ContextMeta, TargetNode} from './abstract';\nimport {hashBlock} from '../hash';\n\nexport class PlaceholderElm extends AbstractElement {\n    hash = hashBlock({\n        type: 'placeholder'\n    });\n\n    targetRender(meta: ContextMeta): TargetNode[] {\n        const t = meta.target;\n        this.targetNodes = [t.createPlaceholder(meta.targetMeta)];\n        return this.targetNodes;\n    }\n\n    merge(meta: ContextMeta, newPlaceholder: PlaceholderElm): PlaceholderElm {\n        return newPlaceholder;\n    }\n}\n","import {AbstractElement, ContextMeta, TargetNode} from './abstract';\nimport {hashBlock} from '../hash';\n\nexport class StringElm extends AbstractElement {\n    text: string;\n\n    constructor (text: string) {\n        super();\n        this.text = text;\n        this.hash = hashBlock({\n            type: 'text',\n            text\n        });\n    }\n\n    targetRender(meta: ContextMeta): TargetNode[] {\n        const t = meta.target;\n        this.targetNodes = [t.createTextNode(meta.targetMeta, this.text)];\n        return this.targetNodes;\n    }\n\n    merge(meta: ContextMeta, newString: StringElm): StringElm {\n        return newString;\n    }\n}\n","import {mixSome} from '../utils/mixin';\nimport {BaseScope} from './base';\nimport {AutoScope} from './auto';\nimport {ArrayScope} from './array';\nimport {AsyncScope} from './async';\nimport {CastScope} from './cast';\nimport {ObjectScope} from './object';\nimport {ProxyScope} from './proxy';\n\nexport const FullScope = mixSome(\n    BaseScope,\n    AutoScope,\n    ArrayScope,\n    AsyncScope,\n    CastScope,\n    ObjectScope,\n    ProxyScope\n) as any as FSClass;\n\nexport interface FSClass {\n    new (...args: any[]): FSType;\n}\n\nexport interface FSType extends BaseScope, AutoScope, AsyncScope, CastScope, ProxyScope, ArrayScope, ObjectScope {}\n","export {BaseScope} from './base';\nexport {AutoScope} from './auto';\nexport {ArrayScope} from './array';\nexport {AsyncScope} from './async';\nexport {CastScope} from './cast';\nexport {FullScope} from './full';\nexport {ObjectScope} from './object';\nexport {ProxyScope} from './proxy';\n","export default \"!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\\\"a\\\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\\\"\\\",e(e.s=1)}([function(t,e,n){\\\"use strict\\\";function r(t,e,n){void 0===e&&(e={}),void 0===n&&(n=[]);var r=t.split(\\\":\\\").reverse(),o=r[0],s=r[1],a=\\\"svg\\\"===s?document.createElementNS(\\\"http://www.w3.org/2000/svg\\\",o):document.createElement(o);return i(a,e),n.forEach(function(t){return\\\"string\\\"==typeof t?a.appendChild(document.createTextNode(t)):a.appendChild(t)}),a}function i(t,e){for(var n in e)t.setAttribute(n,String(e[n]))}Object.defineProperty(e,\\\"__esModule\\\",{value:!0}),e.h=r,e.setAttrs=i;document.head.appendChild(r(\\\"style\\\",{},[\\\"\\\\n    svg {\\\\n        transform-origin: top left;\\\\n    }\\\\n\\\\n    g:hover rect {\\\\n        fill-opacity: 1;\\\\n    }\\\\n\\\\n    rect {\\\\n        cursor: pointer;\\\\n        transform-origin: top left;\\\\n        /*fill: #aea;*/\\\\n        fill-opacity: 0.5;\\\\n        stroke: #8b8;\\\\n        fill-opacity: 0.7;\\\\n        stroke-width: 0.5;\\\\n        transition: width,x .5s ease-in-out;\\\\n        rx: 2;\\\\n        ry: 2;\\\\n    }\\\\n\\\\n    div {\\\\n        width: 500px;\\\\n        overflow-x: scroll;\\\\n        overflow-y: hidden;\\\\n    }\\\\n\\\\n    text {\\\\n        cursor: pointer;\\\\n        font-size: 10px;\\\\n        font-family: monospace;\\\\n    }\\\\n\\\\n    g{\\\\n        transition: transform .5s ease-in-out;\\\\n    }\\\\n\\\"]))},function(t,e,n){\\\"use strict\\\";Object.defineProperty(e,\\\"__esModule\\\",{value:!0});var r=n(2);window.FlameChart=r.FlameChart},function(t,e,n){\\\"use strict\\\";Object.defineProperty(e,\\\"__esModule\\\",{value:!0});var r=n(0),i=n(3),o=i.measureFontWidth(),s=0,a=function(){function t(t,e,n,r,i,o){this.id=s++,this.x=t,this.y=e,this.w=n,this.value=r,this.color=o,this.text=i+\\\"[\\\"+r+\\\"]\\\"}return t.prototype.mount=function(){return this.rect=r.h(\\\"svg:rect\\\",{height:10,y:this.y,x:0,fill:this.color}),this.textElem=r.h(\\\"svg:text\\\",{y:this.y+7,x:o},[this.text]),this.g=r.h(\\\"svg:g\\\",{\\\"data-id\\\":this.id},[this.rect,this.textElem]),this.g},t.prototype.update=function(t,e){var n=this.w*t,s=i.sliceText(this.text,Math.floor(n/o)-2);r.setAttrs(this.rect,{width:n}),this.g.style.transform=\\\"translateX(\\\"+(this.x*t+e)+\\\"px)\\\",this.textElem.textContent=s},t.prototype.render=function(){return this.mount(),this.update(1,0),this.g},t}();e.Block=a;var u=function(){function t(e){var n=this;this.blocks=[],this.focusBlock=function(t){var e=n.data.value/t.value,r=-t.x;n.setViewpoert(e,r)},this.onClick=function(t,e){n.focusBlock(e)},this.config=e;var r=0;this.mapColor=e.mapColor||t.makeColorMapper(function(t){return t.name},function(){return t.getNextHue(1,.5,r++)})}return t.makeColorMapper=function(t,e){var n={};return function(r){var i=t(r),o=n[i];return o||(o=e(i),n[i]=o),o}},t.getNextHue=function(t,e,n){var r=i.getN(360,n),o=[t,e].map(function(t){return Math.round(100*t)+\\\"%\\\"});return\\\"hsl(\\\"+[r,o[0],o[1]].join(\\\", \\\")+\\\")\\\"},t.prototype.setData=function(t){t.children&&t.children.length>1&&(t={name:\\\"root\\\",value:t.children.reduce(function(t,e){return t+e.value},0),children:[t]}),this.data=t},t.prototype.setViewpoert=function(t,e){var n=t<4?t:4,r=this.config.width*n;this.svg.setAttribute(\\\"width\\\",String(r));var i=this.config.width/2*(n-1),o=e*t+i;this.blocks.forEach(function(e){return e.update(t,o)}),this.div.scrollLeft=i},t.prototype.render=function(t){var e=this;this.svg=r.h(\\\"svg:svg\\\",{width:this.config.width,height:this.config.height}),this.div=r.h(\\\"div\\\",{},[this.svg]);var n=this.config.width/this.data.value,i=function(t,r,o){for(var s=r,u=t.children||[],c=0,h=u;c<h.length;c++){var l=h[c],d=s,f=l.value*n;s+=f;var v=e.mapColor(l),p=new a(d,o,f,l.value,l.name,v);e.svg.appendChild(p.render()),e.blocks.push(p),i(l,d,o+12)}};i(this.data,0,0);var o=function(t,n){var r=n.getAttribute(\\\"data-id\\\");if(!r){var i=n.parentElement;if(!i)return;return void o(t,i)}var s=e.blocks[parseInt(r)];e.onClick(t,s)};this.div.addEventListener(\\\"click\\\",function(t){var e=t.target;o(t,e)}),t.appendChild(this.div)},t}();e.FlameChart=u},function(t,e,n){\\\"use strict\\\";function r(t,e){return e<3?\\\"\\\":t.length>e?t.slice(0,e-1)+\\\"\\\":t}function i(){var t=s.h(\\\"svg:text\\\",{opacity:0},[\\\"w\\\"]),e=s.h(\\\"svg:svg\\\",{},[t]);document.body.appendChild(e);var n=t.getBoundingClientRect().width;return e.remove(),n}function o(t,e){for(var n=0;e>0;)t/=2,n+=e%2*t,e=Math.floor(e/2);return n}Object.defineProperty(e,\\\"__esModule\\\",{value:!0});var s=n(0);e.sliceText=r,e.measureFontWidth=i,e.getN=o}]);\\n//# sourceMappingURL=bundle.js.map\";\n","import {CallInfo} from './debug';\nimport flameCode from './flameChart';\n\nexport interface FlameReport {\n    name: string;\n    value: number;\n    children?: FlameReport[];\n}\n\nexport function genReport(renderStack: CallInfo): FlameReport {\n    const name = renderStack.name;\n    const value = isNaN(renderStack.time)\n        ? (renderStack.children || []).reduce((total, cur) => total + cur.time, 0)\n        : renderStack.time;\n\n    if (!renderStack.children || renderStack.children.length <= 0) {\n        return {name, value}\n    }\n\n    const children = renderStack.children.map(genReport);\n\n    return {name, value, children};\n}\n\nexport function createReportIframe(window: any, data: CallInfo) {\n    const json = JSON.stringify(genReport(data));\n    const code = `<html>\n        <head>\n        </head>\n        <body>\n            <div id=\"chart\"></div>\n            <script type=\"text/javascript\" id=\"flame\"></script>\n            <script type=\"text/javascript\" id=\"app\">\n\n            </script>\n        </body>\n    </html>`;\n\n    const ifr = window.document.createElement('iframe');\n    ifr.setAttribute('width', '100%');\n    ifr.setAttribute('height', '1000px');\n    window.document.body.appendChild(ifr);\n    ifr.contentDocument.write(code);\n    const flame = ifr.contentDocument.createElement('script');\n    flame.textContent = flameCode;\n    ifr.contentDocument.body.appendChild(flame);\n    const app = ifr.contentDocument.createElement('script');\n    app.textContent = `\n        var data = ${json};\n\n        const flame = new FlameChart({height: 300, width: 500});\n        flame.setData(data);\n        flame.render(document.body);\n    `;\n    ifr.contentDocument.body.appendChild(app);\n\n}\n","export const now = (typeof window === 'undefined' || typeof window.performance === 'undefined')\n    ? () => Date.now()\n    : () => performance.now();\n","import {now} from './utils';\n\nexport interface CallInfo {\n    name: string;\n    children: CallInfo[];\n    parent: CallInfo | null;\n    totalChildren: number;\n    time: number;\n    data: any;\n}\n\nexport class Tracer {\n    history: CallInfo[] = [];\n\n    private callStack: CallInfo | null = {\n        name: 'root',\n        children: [],\n        parent: null,\n        time: NaN,\n        data: null,\n        totalChildren: 0\n    };\n\n    logCall<T>(name: string, fn: () => T): T {\n        const subInfo: CallInfo = {\n            name,\n            children: [],\n            parent: this.callStack,\n            time: NaN,\n            data: null,\n            totalChildren: 0\n        };\n\n        if (this.callStack === null) {\n            throw new Error('render stack failed');\n        }\n\n        this.callStack.children.push(subInfo);\n        this.callStack.totalChildren++;\n        this.callStack = subInfo;\n\n        const startTime = now();\n        const result = fn();\n        const endTime = now();\n\n        // childrenRendered++;\n\n        this.callStack.time = endTime - startTime;\n\n        this.callStack = this.callStack.parent;\n\n        if (this.callStack === null) {\n            throw new Error('render stack failed');\n        }\n\n        this.callStack.totalChildren += subInfo.totalChildren;\n\n        if (this.callStack.parent === null) {\n            // console.log('children rendered:', childrenRendered);\n            // childrenRendered = 0;\n            this.history.push(this.callStack.children[0]);\n            //this.callStack.report = genReport(this.callStack);\n            //console.log(this.callStack);\n            this.callStack = {\n                name: 'root',\n                children: [],\n                parent: null,\n                time: NaN,\n                data: null,\n                totalChildren: 0\n            };\n        }\n\n        return result;\n    }\n\n    traceMethod = <T>(getName: (obj: T) => string) => (target: T, key: string, descriptor: PropertyDescriptor) => {\n        if (descriptor === undefined) {\n            descriptor = Object.getOwnPropertyDescriptor(target, key) as PropertyDescriptor;\n        }\n\n        const originalMethod = descriptor.value;\n\n        const self = this;\n\n        descriptor.value = function (this: T, ...args: any[]) {\n            return self.logCall(getName(this), () => originalMethod.apply(this, args));\n        };\n\n        return descriptor;\n    }\n}\n","export {Tracer} from './debug';\n\nexport {createReportIframe, genReport} from './report';\n","import {HyperValue} from '../core';\nimport {Tracer, createReportIframe} from 'debug-tools';\n\ninterface HistoryItem {\n    depth: number;\n    state: 'pend' | 'done';\n    hv: HyperValue<any>;\n}\n\nlet currentDepth = 0;\nlet history: HistoryItem[] = [];\n\nfunction pipeLog<T>(hv: any, fn: () => T): T {\n    history.push({\n        depth: currentDepth,\n        hv,\n        state: 'pend'\n    });\n    currentDepth++;\n    const result = fn();\n    currentDepth--;\n    history.push({\n        depth: currentDepth,\n        hv,\n        state: 'done'\n    });\n    return result;\n}\n\nexport function hvDebug(target: {new (...args: any[]): any}) {\n    return class HyperValue extends target {\n        _debug = new Error('');\n        // _name = getName(this._debug.stack || '');\n\n        s(...args: any[]) {\n            return pipeLog(this, () => {\n                return super.s(...args);\n            });\n        }\n    } as any as typeof HyperValue;\n}\n\ndeclare const global: any;\ndeclare const window: any;\n\nconst glob = typeof global !== 'undefined'\n    ? global\n    : window;\n\nexport const tracer = new Tracer();\nglob.tracer = tracer;\nglob.createReportIframe = createReportIframe;\n\nexport const traceHv = tracer.traceMethod((hv: HyperValue<any>) => String(hv.id));\n\nglob.getHvHistory = () => {\n    return 'log:\\n' + history.map(item => {\n        const sign = item.state === 'done' ? '\\\\' : '/';\n        // const name = getName((item.hv as any)._debug.stack);\n        const name = item.hv.id;\n        return '|   '.repeat(item.depth) + `${sign}: ${name}`;\n    }).join('\\n');\n};\n","import {BaseScope} from '../scopes/base';\nimport {report} from '.';\n\nexport function scopeDebug(target: {new (...args: any[]): any}) {\n    return class BaseScope extends target {\n        _debug = new Error('');\n        _watcherCount = 0;\n\n        watch(...args: any[]) {\n            this._watcherCount++;\n\n            if (this._watcherCount > 100) {\n                report(this, `scope watchers over limit: ${this._watcherCount} ws`);\n            }\n\n            return super.watch(...args);\n        }\n\n        unwatch(...args: any[]) {\n            this._watcherCount--;\n            return super.unwatch(...args);\n        }\n    } as any as typeof BaseScope;\n}\n","export interface IdDict<T> {\n    [key: number]: T;\n}\n\nexport class List<T> {\n    private items: IdDict<T> = {};\n    currentId = 0;\n\n    add(item: T): number {\n        const id = this.currentId;\n        this.currentId++;\n        this.items[id] = item;\n        return id;\n    }\n\n    del(id: number) {\n        delete this.items[id];\n    }\n\n    get(id: number) {\n        return this.items[id];\n    }\n\n    set(id: number, value: T) {\n        this.items[id] = value;\n    }\n\n    entries(): [number, T][] {\n        return Object.keys(this.items).map(key => {\n            const id = Number(key);\n            return [id, this.items[id]] as [number, T];\n        });\n    }\n}\n","import {HyperValue} from 'hyper-value';\nimport {jsx, Component} from 'hv-jsx';\nimport {renderIn} from 'hv-dom';\n\nclass App extends Component<{}> {\n    clickTimes = new HyperValue([] as number[]);\n    lastClickTime = this.hs.auto(() => this.clickTimes.$.slice(-1)[0] || 'n/a');\n\n\t// it's a hyper-value represnting the quantity \n\t// of items to show\n\tsliceStart = new HyperValue(-5);\n\t\n\t// now showedLog is always equal to\n\t// 'sliceStart' last elements of clickItems\n\tshowedLog = this.hs.slice(this.clickTimes, this.sliceStart);\n    \n\thandleClick = () => {\n\t\tthis.hs.insert(this.clickTimes, Infinity, Date.now());\n\t}\n\n\thandleShowedCountChnage = (e: Event) => {\n\t\tconst elem = e.target  as  HTMLInputElement;\n\t\tthis.sliceStart.$  =  -Number(elem.value  ||  0)\n\t}\n\n    render() {\n        return <div>\n            <span>Last click time: {this.lastClickTime}</span>\n            <button onClick={this.handleClick}>Click me!</button>\n            <div>\n\t\t\t    <h5>Log:</h5>\n\t\t\t    Show  last  <input  type='number'  onInput={this.handleShowedCountChnage}/>  entries:\n\t\t\t    <ol>{\n\t\t\t        this.hs.map(this.showedLog, item => {\n\t\t\t            const dateString = (new Date(item)).toString();\n\t\t\t            return <li>{dateString}</li>;\n\t\t\t        })\n\t\t\t    }</ol>\n\t\t\t</div>\n        </div>;\n    }\n}\n\nrenderIn(document.body, {}, <App />); \n"],"sourceRoot":""}